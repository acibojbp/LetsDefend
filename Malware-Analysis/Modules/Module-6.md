# Malicious Document Analysis

## Contents
- [Static Malicious Document Analysis](#static-malicious-document-analysis)
- [More Details About Document File Analysis 2](#more-details-about-document-file-analysis-2)
- [Analysis with Sandboxes](#analysis-with-sandboxes)
- [Challenges](#challenges)
  - [Excel 4.0 Macros](#excel-40-macros)
  - [Malicious Doc](#malicious-doc)

## Static Malicious Document Analysis

What is the MD5 value of the `/root/Desktop/QuestionFiles/PO-465514-180820.doc` file?  
`d7e6921bfd008f707ba52dee374ff3db`

What is the file type of the `/home/analyst/PO-465514-180820.doc` file?  
`doc`

![M6-01](https://github.com/acibojbp/LetsDefend/assets/164168280/f68c7e64-0229-4b65-aec2-2fd0dc16a5c4)

## More Details About Document File Analysis 2

Does the file `/root/Desktop/QuestionFiles/PO-465514-180820.doc` contain a VBA macro?   
`Y`

![M6-02](https://github.com/acibojbp/LetsDefend/assets/164168280/1b9728be-21d8-4faa-aec8-d40b7422d00c)

Some malicious activity occurs when the document file `/root/Desktop/QuestionFiles/PO-465514-180820.doc` is opened. What is the macro keyword that enables this?  
`Document_open`

![M6-03](https://github.com/acibojbp/LetsDefend/assets/164168280/a7f6f50e-2c94-4acb-8a0b-e63c43c5abc7)

Who is the author of the file `/root/Desktop/QuestionFiles/PO-465514-180820.doc`?  
`Alexandre Riviere`

What is the last saved time of the `/root/Desktop/QuestionFiles/PO-465514-180820.doc` file?  
`2020-08-18 08:19:00`

![M6-04](https://github.com/acibojbp/LetsDefend/assets/164168280/e7872cf6-b1aa-4f46-80d0-ec9df17db5ff)

The malicious file `Siparis_17.xls` is trying to download files from an address. From which domain is it trying to download the file?  
`hocoso.mobi`

![M6-05](https://github.com/acibojbp/LetsDefend/assets/164168280/61c0a27d-640f-4cc3-a85b-834b1d5a0caf)

How many IOCs are in the `Siparis_17.xls` file according to the Olevba tool?  
`2`

![M6-06](https://github.com/acibojbp/LetsDefend/assets/164168280/609a8a3b-7af2-4d6c-8c67-edf4d24344e9)

## Analysis with Sandboxes

The file `PO-465514-180820.doc` is trying to make a request to a domain ending with `.kz`. What is this domain?  
 `msbc.kz`

![M6-07](https://github.com/acibojbp/LetsDefend/assets/164168280/37f48540-bde5-49a5-87e2-2e42ddf3a50e)

With which Windows tool are the connection requests made? (file:PO-465514-180820.doc)  
`powershell.exe`

![M6-08](https://github.com/acibojbp/LetsDefend/assets/164168280/17f607d9-c7a4-4b63-a444-8a314611418c)

How many addresses does the file send DNS requests to? (file:PO-465514-180820.doc)  
`5`

The `Siparis_17.xls` malware document is trying to download a file. With what name does he want to save the file it is trying to download to the device?  
`6LeGwKmrm.jar`

![M6-09](https://github.com/acibojbp/LetsDefend/assets/164168280/e36e7ed0-acca-4911-956f-96e266c2fdb6)
